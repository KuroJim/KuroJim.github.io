<!DOCTYPE html><html lang="zh-CN"> <head><meta charset="UTF-8"><meta name="description" content="Docker 是现代开发必备的工具。本文通过实际案例，教你如何使用 Docker 搭建一致的开发环境，解决&#34;在我机器上能跑&#34;的问题。"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.16.19"><link rel="canonical" href="https://kurojim.github.io/blog/docker-practical-guide.html"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://kurojim.github.io/blog/docker-practical-guide.html"><meta property="og:title" content="Docker 实战：从零搭建开发环境 - KuroJim"><meta property="og:description" content="Docker 是现代开发必备的工具。本文通过实际案例，教你如何使用 Docker 搭建一致的开发环境，解决&#34;在我机器上能跑&#34;的问题。"><meta property="og:image" content="https://kurojim.github.io/images/og-image.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://kurojim.github.io/blog/docker-practical-guide.html"><meta property="twitter:title" content="Docker 实战：从零搭建开发环境 - KuroJim"><meta property="twitter:description" content="Docker 是现代开发必备的工具。本文通过实际案例，教你如何使用 Docker 搭建一致的开发环境，解决&#34;在我机器上能跑&#34;的问题。"><meta property="twitter:image" content="https://kurojim.github.io/images/og-image.jpg"><title>Docker 实战：从零搭建开发环境 - KuroJim</title><!-- Preload Fonts --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="/_astro/_slug_.B7zqmKbN.css">
<link rel="stylesheet" href="/_astro/_slug_.BSuBZlXj.css"><script type="module" src="/_astro/hoisted.jp3knyGQ.js"></script></head> <body class="bg-apple-gray-50 text-apple-gray-800 antialiased"> <div class="min-h-screen flex flex-col">  <header class="fixed top-0 left-0 right-0 z-50 backdrop-blur-xl bg-white/60 dark:bg-black/40 border-b border-apple-gray-200/40 supports-[backdrop-filter]:bg-white/70"> <nav class="max-w-5xl mx-auto px-6 sm:px-8"> <div class="flex items-center justify-between h-14"> <!-- Logo --> <a href="/" class="text-xl font-semibold text-apple-gray-900 hover:text-apple-blue transition-colors">
KuroJim
</a> <!-- Desktop Navigation --> <ul class="hidden md:flex items-center gap-8"> <li> <a href="/" class="text-sm text-apple-gray-600 hover:text-apple-blue transition-colors"> 首页 </a> </li><li> <a href="/blog" class="text-sm text-apple-gray-600 hover:text-apple-blue transition-colors"> 博客 </a> </li> </ul> <!-- Mobile Menu Button --> <button id="mobile-menu-button" class="md:hidden p-2 -mr-2 text-apple-gray-600 hover:text-apple-blue transition-colors" aria-label="Toggle menu"> <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </button> </div> <!-- Mobile Navigation --> <div id="mobile-menu" class="md:hidden hidden pb-4"> <ul class="flex flex-col gap-2"> <li> <a href="/" class="block py-2 text-sm text-apple-gray-600 hover:text-apple-blue transition-colors"> 首页 </a> </li><li> <a href="/blog" class="block py-2 text-sm text-apple-gray-600 hover:text-apple-blue transition-colors"> 博客 </a> </li> </ul> </div> </nav> </header>  <main class="flex-1 pt-14" data-astro-cid-4sn4zg3r> <!-- Progress Bar --> <div class="fixed top-14 left-0 right-0 h-[2px] bg-apple-gray-200/50 z-40" data-astro-cid-4sn4zg3r> <div class="h-full bg-apple-blue origin-left scale-x-0 reading-progress-bar" data-astro-cid-4sn4zg3r></div> </div> <article class="max-w-4xl mx-auto px-6 sm:px-8 py-16 sm:py-24 relative" data-astro-cid-4sn4zg3r> <!-- Article Header --> <header class="mb-16 max-w-3xl" data-astro-cid-4sn4zg3r> <!-- Tags --> <div class="flex flex-wrap gap-2 mb-5" data-astro-cid-4sn4zg3r> <span class="inline-flex items-center px-2.5 py-1 text-xs font-medium bg-apple-blue/10 text-apple-blue rounded-full" data-astro-cid-4sn4zg3r> Docker </span><span class="inline-flex items-center px-2.5 py-1 text-xs font-medium bg-apple-blue/10 text-apple-blue rounded-full" data-astro-cid-4sn4zg3r> DevOps </span><span class="inline-flex items-center px-2.5 py-1 text-xs font-medium bg-apple-blue/10 text-apple-blue rounded-full" data-astro-cid-4sn4zg3r> 后端开发 </span> </div> <!-- Title --> <h1 class="text-4xl sm:text-5xl md:text-6xl font-semibold text-apple-gray-900 mb-5 leading-[1.1] tracking-tight" data-astro-cid-4sn4zg3r> Docker 实战：从零搭建开发环境 </h1> <!-- Description --> <p class="text-lg text-apple-gray-600 mb-6 leading-relaxed font-normal" data-astro-cid-4sn4zg3r> Docker 是现代开发必备的工具。本文通过实际案例，教你如何使用 Docker 搭建一致的开发环境，解决&quot;在我机器上能跑&quot;的问题。 </p> <!-- Meta Info Card --> <div class="flex items-center gap-5 text-sm text-apple-gray-500" data-astro-cid-4sn4zg3r> <div class="flex items-center gap-1.5" data-astro-cid-4sn4zg3r> <svg class="w-3.5 h-3.5 text-apple-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-4sn4zg3r> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-astro-cid-4sn4zg3r></path> </svg> <time datetime="2024-02-05T00:00:00.000Z" data-astro-cid-4sn4zg3r> 2024年2月5日 </time> </div>  </div> </header> <!-- Hero Image -->  <!-- Article Content with Apple-style typography --> <div class="prose prose-apple max-w-none" data-astro-cid-4sn4zg3r> <h2 id="为什么需要-docker">为什么需要 Docker？</h2>
<p>你是否遇到过这种情况：</p>
<ul>
<li>在你机器上运行正常，在同事机器上就报错</li>
<li>新人入职需要花一天时间配置开发环境</li>
<li>不同项目需要不同版本的 Node.js、Python 等运行时</li>
</ul>
<p>Docker 可以完美解决这些问题。</p>
<h2 id="docker-基础概念">Docker 基础概念</h2>
<h3 id="镜像image">镜像（Image）</h3>
<p>镜像是一个只读的模板，包含了运行应用所需的一切：</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="dockerfile"><code><span class="line"><span style="color:#6A737D"># Node.js 应用的 Dockerfile</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> node:20-alpine</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">WORKDIR</span><span style="color:#E1E4E8"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> package*.json ./</span></span>
<span class="line"><span style="color:#F97583">RUN</span><span style="color:#E1E4E8"> npm ci --only=production</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> . .</span></span>
<span class="line"><span style="color:#F97583">EXPOSE</span><span style="color:#E1E4E8"> 3000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">CMD</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"npm"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"start"</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span></code></pre>
<h3 id="容器container">容器（Container）</h3>
<p>容器是镜像运行时的实例：</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># 构建镜像</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> build</span><span style="color:#79B8FF"> -t</span><span style="color:#9ECBFF"> myapp:1.0</span><span style="color:#9ECBFF"> .</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 运行容器</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> run</span><span style="color:#79B8FF"> -p</span><span style="color:#9ECBFF"> 3000:3000</span><span style="color:#9ECBFF"> myapp:1.0</span></span>
<span class="line"></span></code></pre>
<h3 id="docker-compose">Docker Compose</h3>
<p>Docker Compose 用于定义和运行多容器应用：</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#6A737D"># docker-compose.yml</span></span>
<span class="line"><span style="color:#85E89D">version</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'3.8'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">services</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  app</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    build</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">.</span></span>
<span class="line"><span style="color:#85E89D">    ports</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">"3000:3000"</span></span>
<span class="line"><span style="color:#85E89D">    environment</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">NODE_ENV=production</span></span>
<span class="line"><span style="color:#85E89D">    depends_on</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">db</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">  db</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    image</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">postgres:16</span></span>
<span class="line"><span style="color:#85E89D">    environment</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">POSTGRES_DB=myapp</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">POSTGRES_USER=user</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">POSTGRES_PASSWORD=pass</span></span>
<span class="line"><span style="color:#85E89D">    volumes</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">postgres_data:/var/lib/postgresql/data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">volumes</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  postgres_data</span><span style="color:#E1E4E8">:</span></span>
<span class="line"></span></code></pre>
<h2 id="实战案例全栈应用-docker-化">实战案例：全栈应用 Docker 化</h2>
<h3 id="项目结构">项目结构</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>myapp/</span></span>
<span class="line"><span>├── frontend/          # React 前端</span></span>
<span class="line"><span>├── backend/           # Node.js 后端</span></span>
<span class="line"><span>├── docker-compose.yml</span></span>
<span class="line"><span>└── .env</span></span>
<span class="line"><span></span></span></code></pre>
<h3 id="前端-dockerfile">前端 Dockerfile</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="dockerfile"><code><span class="line"><span style="color:#6A737D"># frontend/Dockerfile</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> node:20-alpine </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> builder</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">WORKDIR</span><span style="color:#E1E4E8"> /app</span></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> package*.json ./</span></span>
<span class="line"><span style="color:#F97583">RUN</span><span style="color:#E1E4E8"> npm ci</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> . .</span></span>
<span class="line"><span style="color:#F97583">RUN</span><span style="color:#E1E4E8"> npm run build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> nginx:alpine</span></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> --from=builder /app/dist /usr/share/nginx/html</span></span>
<span class="line"><span style="color:#F97583">EXPOSE</span><span style="color:#E1E4E8"> 80</span></span>
<span class="line"><span style="color:#F97583">CMD</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"nginx"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"-g"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"daemon off;"</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span></code></pre>
<h3 id="后端-dockerfile">后端 Dockerfile</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="dockerfile"><code><span class="line"><span style="color:#6A737D"># backend/Dockerfile</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> node:20-alpine</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">WORKDIR</span><span style="color:#E1E4E8"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> package*.json ./</span></span>
<span class="line"><span style="color:#F97583">RUN</span><span style="color:#E1E4E8"> npm ci --only=production</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> . .</span></span>
<span class="line"><span style="color:#F97583">EXPOSE</span><span style="color:#E1E4E8"> 4000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">CMD</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"node"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"src/index.js"</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span></code></pre>
<h3 id="docker-compose-配置">Docker Compose 配置</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#85E89D">version</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'3.8'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">services</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  frontend</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    build</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">./frontend</span></span>
<span class="line"><span style="color:#85E89D">    ports</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">"80:80"</span></span>
<span class="line"><span style="color:#85E89D">    depends_on</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">backend</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">  backend</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    build</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">./backend</span></span>
<span class="line"><span style="color:#85E89D">    ports</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">"4000:4000"</span></span>
<span class="line"><span style="color:#85E89D">    environment</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">NODE_ENV=production</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">DB_HOST=postgres</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">REDIS_HOST=redis</span></span>
<span class="line"><span style="color:#85E89D">    depends_on</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">postgres</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">redis</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">  postgres</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    image</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">postgres:16-alpine</span></span>
<span class="line"><span style="color:#85E89D">    environment</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">POSTGRES_DB=myapp</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">POSTGRES_USER=user</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">POSTGRES_PASSWORD=${DB_PASSWORD}</span></span>
<span class="line"><span style="color:#85E89D">    volumes</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">postgres_data:/var/lib/postgresql/data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">  redis</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    image</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">redis:7-alpine</span></span>
<span class="line"><span style="color:#85E89D">    volumes</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">redis_data:/data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">volumes</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  postgres_data</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  redis_data</span><span style="color:#E1E4E8">:</span></span>
<span class="line"></span></code></pre>
<h2 id="开发环境最佳实践">开发环境最佳实践</h2>
<h3 id="1-使用开发容器">1. 使用开发容器</h3>
<p>为开发环境创建单独的配置：</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#6A737D"># docker-compose.dev.yml</span></span>
<span class="line"><span style="color:#85E89D">version</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'3.8'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">services</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  backend</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    build</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      context</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">./backend</span></span>
<span class="line"><span style="color:#85E89D">      target</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">development</span></span>
<span class="line"><span style="color:#85E89D">    volumes</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">./backend:/app</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">/app/node_modules</span></span>
<span class="line"><span style="color:#85E89D">    environment</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">NODE_ENV=development</span></span>
<span class="line"><span style="color:#85E89D">    command</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">npm run dev</span></span>
<span class="line"></span></code></pre>
<h3 id="2-热重载">2. 热重载</h3>
<p>挂载源代码目录实现热重载：</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#85E89D">volumes</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">  - </span><span style="color:#9ECBFF">./src:/app/src</span></span>
<span class="line"><span style="color:#E1E4E8">  - </span><span style="color:#9ECBFF">/app/node_modules</span><span style="color:#6A737D">  # 防止覆盖 node_modules</span></span>
<span class="line"></span></code></pre>
<h3 id="3-环境变量管理">3. 环境变量管理</h3>
<p>使用 <code>.env</code> 文件管理环境变量：</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># .env</span></span>
<span class="line"><span style="color:#E1E4E8">DB_PASSWORD</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">secure_password</span></span>
<span class="line"><span style="color:#E1E4E8">JWT_SECRET</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">your_secret_key</span></span>
<span class="line"><span style="color:#E1E4E8">API_KEY</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">your_api_key</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#6A737D"># docker-compose.yml</span></span>
<span class="line"><span style="color:#85E89D">services</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  app</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    env_file</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#9ECBFF">.env</span></span>
<span class="line"></span></code></pre>
<h2 id="生产环境优化">生产环境优化</h2>
<h3 id="1-多阶段构建">1. 多阶段构建</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="dockerfile"><code><span class="line"><span style="color:#6A737D"># 构建阶段</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> node:20-alpine </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> builder</span></span>
<span class="line"><span style="color:#F97583">WORKDIR</span><span style="color:#E1E4E8"> /app</span></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> package*.json ./</span></span>
<span class="line"><span style="color:#F97583">RUN</span><span style="color:#E1E4E8"> npm ci</span></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> . .</span></span>
<span class="line"><span style="color:#F97583">RUN</span><span style="color:#E1E4E8"> npm run build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 运行阶段</span></span>
<span class="line"><span style="color:#F97583">FROM</span><span style="color:#E1E4E8"> node:20-alpine</span></span>
<span class="line"><span style="color:#F97583">WORKDIR</span><span style="color:#E1E4E8"> /app</span></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> package*.json ./</span></span>
<span class="line"><span style="color:#F97583">RUN</span><span style="color:#E1E4E8"> npm ci --only=production</span></span>
<span class="line"><span style="color:#F97583">COPY</span><span style="color:#E1E4E8"> --from=builder /app/dist ./dist</span></span>
<span class="line"><span style="color:#F97583">CMD</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">"node"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"dist/index.js"</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span></code></pre>
<h3 id="2-镜像优化">2. 镜像优化</h3>
<ul>
<li>使用 <code>alpine</code> 基础镜像</li>
<li>合并 RUN 指令减少层数</li>
<li>清理不必要的文件</li>
<li>使用 <code>.dockerignore</code></li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span># .dockerignore</span></span>
<span class="line"><span>node_modules</span></span>
<span class="line"><span>npm-debug.log</span></span>
<span class="line"><span>.git</span></span>
<span class="line"><span>.env</span></span>
<span class="line"><span></span></span></code></pre>
<h3 id="3-安全扫描">3. 安全扫描</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># 使用 Trivy 扫描镜像漏洞</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> run</span><span style="color:#79B8FF"> --rm</span><span style="color:#79B8FF"> -v</span><span style="color:#9ECBFF"> /var/run/docker.sock:/var/run/docker.sock</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#9ECBFF">  aquasec/trivy</span><span style="color:#9ECBFF"> image</span><span style="color:#9ECBFF"> myapp:1.0</span></span>
<span class="line"></span></code></pre>
<h2 id="常用命令速查">常用命令速查</h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># 构建镜像</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> build</span><span style="color:#79B8FF"> -t</span><span style="color:#9ECBFF"> myapp:1.0</span><span style="color:#9ECBFF"> .</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 运行容器</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> run</span><span style="color:#79B8FF"> -d</span><span style="color:#79B8FF"> -p</span><span style="color:#9ECBFF"> 8080:80</span><span style="color:#79B8FF"> --name</span><span style="color:#9ECBFF"> myapp</span><span style="color:#9ECBFF"> myapp:1.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 查看日志</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> logs</span><span style="color:#79B8FF"> -f</span><span style="color:#9ECBFF"> myapp</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 进入容器</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> exec</span><span style="color:#79B8FF"> -it</span><span style="color:#9ECBFF"> myapp</span><span style="color:#9ECBFF"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 停止并删除容器</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> stop</span><span style="color:#9ECBFF"> myapp</span><span style="color:#E1E4E8"> &#x26;&#x26; </span><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> rm</span><span style="color:#9ECBFF"> myapp</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># 删除镜像</span></span>
<span class="line"><span style="color:#B392F0">docker</span><span style="color:#9ECBFF"> rmi</span><span style="color:#9ECBFF"> myapp:1.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Docker Compose</span></span>
<span class="line"><span style="color:#B392F0">docker-compose</span><span style="color:#9ECBFF"> up</span><span style="color:#79B8FF"> -d</span></span>
<span class="line"><span style="color:#B392F0">docker-compose</span><span style="color:#9ECBFF"> logs</span><span style="color:#79B8FF"> -f</span></span>
<span class="line"><span style="color:#B392F0">docker-compose</span><span style="color:#9ECBFF"> down</span></span>
<span class="line"><span style="color:#B392F0">docker-compose</span><span style="color:#9ECBFF"> exec</span><span style="color:#9ECBFF"> backend</span><span style="color:#9ECBFF"> sh</span></span>
<span class="line"></span></code></pre>
<h2 id="总结">总结</h2>
<p>Docker 是现代开发的必备技能，它带来的好处包括：</p>
<ol>
<li><strong>环境一致性</strong>：所有人使用相同的开发环境</li>
<li><strong>快速上手</strong>：新成员只需运行 <code>docker-compose up</code></li>
<li><strong>隔离性</strong>：不同项目互不影响</li>
<li><strong>简化部署</strong>：开发、测试、生产环境完全一致</li>
</ol>
<p>如果你还没有使用 Docker，现在就开始吧！从简单的单容器应用开始，逐步掌握多容器编排，你会发现开发效率大幅提升。</p>
<p>推荐资源：</p>
<ul>
<li><a href="https://docs.docker.com/">Docker 官方文档</a></li>
<li><a href="https://docs.docker.com/compose/">Docker Compose 文档</a></li>
<li><a href="https://docs.docker.com/develop/dev-best-practices/">最佳实践</a></li>
</ul> </div> <!-- Article Footer --> <footer class="mt-24 pt-10 border-t border-apple-gray-200" data-astro-cid-4sn4zg3r> <!-- Edit on GitHub --> <div class="mb-10 p-5 bg-gradient-to-r from-apple-gray-50 to-white rounded-2xl border border-apple-gray-200" data-astro-cid-4sn4zg3r> <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4" data-astro-cid-4sn4zg3r> <div data-astro-cid-4sn4zg3r> <h3 class="font-semibold text-apple-gray-900 mb-1" data-astro-cid-4sn4zg3r>发现错误或想要改进？</h3> <p class="text-sm text-apple-gray-600" data-astro-cid-4sn4zg3r>你可以在 GitHub 上直接编辑这篇文章，或提交问题反馈。</p> </div> <div class="flex items-center gap-3" data-astro-cid-4sn4zg3r> <a href="https://github.com/KuroJim/KuroJim.github.io/edit/master/src/content/blog/docker-practical-guide.md" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-5 py-2.5 bg-apple-gray-900 text-white text-sm rounded-full hover:bg-apple-gray-800 transition-all duration-200 shadow-apple hover:shadow-apple-md font-medium" data-astro-cid-4sn4zg3r> <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" data-astro-cid-4sn4zg3r> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" data-astro-cid-4sn4zg3r></path> </svg> <span data-astro-cid-4sn4zg3r>编辑文章</span> </a> <a href="https://github.com/KuroJim/KuroJim.github.io/issues/new?title=[Feedback]%20Docker%20%E5%AE%9E%E6%88%98%EF%BC%9A%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-5 py-2.5 bg-white text-apple-gray-700 text-sm rounded-full hover:shadow-sm transition-all duration-200 border border-apple-gray-200 hover:border-apple-gray-300 font-medium" data-astro-cid-4sn4zg3r> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-4sn4zg3r> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-astro-cid-4sn4zg3r></path> </svg> <span data-astro-cid-4sn4zg3r>反馈问题</span> </a> </div> </div> </div> <!-- Author Card --> <div class="mb-10 p-5 bg-apple-gray-50 rounded-2xl" data-astro-cid-4sn4zg3r> <div class="flex items-start gap-4" data-astro-cid-4sn4zg3r> <div class="w-12 h-12 rounded-full bg-gradient-to-br from-apple-blue to-purple-500 p-[2px] flex-shrink-0" data-astro-cid-4sn4zg3r> <div class="w-full h-full rounded-full bg-white flex items-center justify-center" data-astro-cid-4sn4zg3r> <span class="text-lg font-semibold bg-gradient-to-br from-apple-gray-800 to-apple-gray-600 bg-clip-text text-transparent" data-astro-cid-4sn4zg3r>KJ</span> </div> </div> <div data-astro-cid-4sn4zg3r> <div class="font-semibold text-apple-gray-900 mb-0.5" data-astro-cid-4sn4zg3r>Quanjia Xiao</div> <p class="text-sm text-apple-gray-600 leading-relaxed" data-astro-cid-4sn4zg3r>
北京大学研究生 · AI 算法研究员
</p> </div> </div> </div> <!-- Navigation --> <nav class="flex justify-between gap-4 mb-10" data-astro-cid-4sn4zg3r> <a href="/blog/typescript-advanced-tips" class="flex-1 p-4 bg-white rounded-xl hover:shadow-sm transition-all duration-200 group border border-apple-gray-200" data-astro-cid-4sn4zg3r> <div class="flex items-center gap-1.5 text-xs text-apple-gray-500 mb-1.5" data-astro-cid-4sn4zg3r> <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-4sn4zg3r> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" data-astro-cid-4sn4zg3r></path> </svg>
上一篇
</div> <div class="text-sm font-medium text-apple-gray-900 group-hover:text-apple-blue transition-colors line-clamp-2" data-astro-cid-4sn4zg3r> TypeScript 高级技巧：提升代码质量 </div> </a> <a href="/blog/frontend-tech-stack-2024" class="flex-1 p-4 bg-white rounded-xl hover:shadow-sm transition-all duration-200 group border border-apple-gray-200 text-right" data-astro-cid-4sn4zg3r> <div class="flex items-center justify-end gap-1.5 text-xs text-apple-gray-500 mb-1.5" data-astro-cid-4sn4zg3r>
下一篇
<svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-4sn4zg3r> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-astro-cid-4sn4zg3r></path> </svg> </div> <div class="text-sm font-medium text-apple-gray-900 group-hover:text-apple-blue transition-colors line-clamp-2" data-astro-cid-4sn4zg3r> 2024 年前端技术栈选择指南 </div> </a> </nav> <!-- Back to List --> <div class="flex justify-center" data-astro-cid-4sn4zg3r> <a href="/blog" class="inline-flex items-center gap-2 px-6 py-2.5 bg-white text-apple-gray-700 text-sm rounded-full hover:shadow-sm transition-all duration-200 border border-apple-gray-200 hover:border-apple-gray-300" data-astro-cid-4sn4zg3r> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-4sn4zg3r> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" data-astro-cid-4sn4zg3r></path> </svg> <span data-astro-cid-4sn4zg3r>返回博客列表</span> </a> </div> </footer> <!-- Comments Section --> <section class="mt-16 pt-8 border-t border-apple-gray-200" data-astro-cid-4sn4zg3r> <h2 class="text-xl font-semibold text-apple-gray-900 mb-6" data-astro-cid-4sn4zg3r>评论</h2> <script src="https://giscus.app/client.js" data-repo="KuroJim/KuroJim.github.io" data-repo-id="R_kgDONLxxxx" data-category="General" data-category-id="DIC_kwDONLxxxx" data-mapping="pathname" data-strict="0" data-theme="light" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async>
</script>  </section> </article> </main> <footer class="mt-auto border-t border-apple-gray-200/40 bg-white/80 backdrop-blur-sm"> <div class="max-w-5xl mx-auto px-6 sm:px-8 py-10"> <div class="flex flex-col sm:flex-row justify-between items-center gap-6"> <!-- Copyright --> <p class="text-sm text-apple-gray-500">
© 2026 KuroJim. All rights reserved.
</p> <!-- Social Links --> <div class="flex items-center gap-6"> <a href="https://github.com/KuroJim" target="_blank" rel="noopener noreferrer" class="text-apple-gray-500 hover:text-apple-blue transition-colors duration-200" aria-label="GitHub"> <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </svg> </a> <a href="mailto:xiaoqj@stu.pku.edu.cn" class="text-apple-gray-500 hover:text-apple-blue transition-colors duration-200" aria-label="Email"> <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path> </svg> </a> <a href="https://twitter.com/KuroJim" target="_blank" rel="noopener noreferrer" class="text-apple-gray-500 hover:text-apple-blue transition-colors duration-200" aria-label="Twitter"> <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"> <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path> </svg> </a> </div> </div> <!-- Powered by --> <div class="mt-6 text-center"> <p class="text-xs text-apple-gray-400">
Powered by <a href="https://astro.build" target="_blank" rel="noopener noreferrer" class="hover:text-apple-blue transition-colors duration-200">Astro</a> </p> </div> </div> </footer>  </div> </body></html>  