---
interface Props {
  post: {
    slug: string;
    data: {
      title: string;
      description: string;
      pubDate: Date;
      tags: string[];
      heroImage?: string;
    };
  };
}

const { post } = Astro.props;

const { slug, data } = post;
const { title, description, pubDate, tags, heroImage } = data;

const formatDate = (date: Date) => {
  return new Date(date).toLocaleDateString('zh-CN', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
};
---

<a href={`/blog/${slug}`} class="group block">
  <article class="h-full p-7 sm:p-8 bg-white/80 backdrop-blur-sm rounded-3xl hover:shadow-apple-md transition-all duration-300 border border-apple-gray-200/50 hover:border-apple-blue/30 hover:-translate-y-1">
    <!-- Hero Image -->
    {heroImage && (
      <div class="mb-6 aspect-video rounded-2xl overflow-hidden bg-apple-gray-100">
        <img
          src={heroImage}
          alt={title}
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
          loading="lazy"
        />
      </div>
    )}

    <!-- Tags -->
    {tags.length > 0 && (
      <div class="flex flex-wrap gap-2 mb-4">
        {tags.map((tag) => (
          <span class="inline-flex items-center px-3 py-1 text-xs font-medium bg-apple-blue/10 text-apple-blue rounded-full">
            {tag}
          </span>
        ))}
      </div>
    )}

    <!-- Title -->
    <h2 class="text-xl sm:text-2xl font-semibold text-apple-gray-900 mb-3 group-hover:text-apple-blue transition-colors line-clamp-2">
      {title}
    </h2>

    <!-- Description -->
    <p class="text-apple-gray-600 mb-5 line-clamp-3 leading-relaxed">
      {description}
    </p>

    <!-- Footer -->
    <div class="flex items-center justify-between text-sm text-apple-gray-500">
      <time datetime={pubDate.toISOString()}>
        {formatDate(pubDate)}
      </time>
      <span class="inline-flex items-center gap-1 group-hover:gap-2 transition-all text-apple-blue">
        阅读更多
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </span>
    </div>
  </article>
</a>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
